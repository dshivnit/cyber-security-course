
- Any software that is designed to infiltrate a computer system without the user's knowledge
-  Malware needs to create a threat vector and an attack vector
	- Threat Vector
		- Specific method used by an attacker to infiltrate a victim's machine
		- The how, the plan, to get into a system
			- Unpatched software
			- Installing code on via a USB thumbdrive
			- Phishing campaign
			- Other vulns and exploits that can be taken advantage of
	- Attack Vector
		- A means by which an attacker gains access to a computer to infect the system with malware
		- Breaking into and infecting a system

- Malware Attacks
	- Ransomware
	- Trojan
	- Worm
	- Spyware
	- Bloatware
	- Virus
	- Keylogger
	- Logic bomb
	- Rootkit

- Virus
	-  Malicious software that attaches to clean files and spreads into a computer system
- Worms
	- Standalone malware programs that replicate and spread to other systems by exploiting software vulnerabilities
- Trojans
	- Malicious programs which appear to be legitimate software that allow unauthorised access to a victim's system when executed
- Ransomware
	- Encrypts a user's data and holds it hostage until a ransom is paid before decrypting it
- Zombies
	- Compromised computers that are remotely controlled by attackers and used in coordination to form a botnet
	- Botnet
		- Network of zombies and are often used for DDoS attacks, spam distribution, or cryptocurrency mining
- Rootkits
	- Malicious tools that hide their activities and operate at the OS level, or below!, to allow for ongoing privileged access
- Backdoors
	- Malicious means of bypassing normal authentication processes to gain unauthorised access to a system
- Logic Bombs
	- Embedded code placed in legitimate programs that executes a malicious action when a specific condition or trigger occurs
- Keyloggers
	- Stealthy tools or malware variants used to capture keystores or capture passwords or other sensitive information
- Spyware
	- Software that secretly monitors and gathers user information or activities and sends data to third parties
- Bloatware
	- Unnecessary or pre-installed software that consumes system resources and space without offering any value to the user

- Malware exploitation techniques
	- Involve methods by which malware infiltrate and infects targeted systems

- Viruses
	- Malicious code that's run on a machine without the user's knowledge and this allows the code to infect the computer whenever it has been run
	- Will want to spread across the system and network for the most part
	- Start using resources on the system
	- Types:
		- Boot Sector
			- Stored in the first sector of a hard drive and is then loaded into memory whenever the computer boots up
			- To find and remove these viruses, use an antivirus that specifically looks for boot sector viruses
		- Macro
			- A form of code that allows a virus to be embedded inside another document so that when that document is opened by the user, the virus is executed 
		- Program
			- Tries to find executables or application files to infect with their malicious code 
			- Infecting one application say for example, so that whenever it opens up the virus runs and starts to do its thing - will reinfect the system time after time after the user opens the infected application
		- Multipartite
			- Combination of a boot sector and program type of virus
			- The virus can place itself in the boot sector, then when its loaded up at boot time, it can then install itself to launch whenever the infected application is launched
				- So even if an anti-virus program happens to find the infection on the given application, it may have missed the boot-sector part of the virus
		- Encrypted
			- Designed to hide itself from being detected by encrypting its malicious code or payloads to avoid detection by any antivirus software 
			- May get harder for antivirus providers from finding these encrypted variants as it could be scrambled encrypted in code
		- Polymorphic
			- Advanced version of an encrypted virus, but instead of just encrypted the contents, it will actually change the virus's code each time it is executed by altering the decryption module in order for it to evade detection
		- Metamorphic
			- Able to rewrite itself entirely before it attempts to infect a given file
			- More advanced version of a polymorphic virus
		- Stealth
			- Not necessarily a specific type of virus as much as it is a technique used to prevent the virus from being detected by the anti-virus software
		- Armored Virus
			- A layer of protection to confuse a program or a person who's trying to analyse it
		- Hoax
			- A form of technical social engineering that attempts to scare end users into taking undesirable action on their system
	- A virus is simply made up of malicious code that's run on a machine without the user's knowledge and this allows the code to infect the computer whenever it has been run
	- A virus will typically require a user to perform some kind of action to engage it

- Worms
	- Piece of malicious software, much like a virus, but it can replicate itself without any user interaction
	- Doesn't need a user's consent and/or action
		- Can infect the workstation and other computing assets
		- Can cause disruptions to the normal network traffic since they are constantly trying to replicate and spread across the network
			- Can start to slow the network down, computer power, capacity
			- If the replication is happening too rapidly for example, it can inadvertently cause a DOS to systems
	- Known best for spreading far and wide over the Internet in a relatively short amount of time
	- Conficker is one of the largest worms, first discovered in 2008

- Trojans
	- A piece of malicious software that is disguised as a piece of harmless or desirable software
	- RAT
		- Remote Access Trojan
		- Type of Trojan that is widely used by modern attackers because it provides the attacker with remote control of a victim machine
	- Commonly used today by attackers to exploit a vulnerability in a workstation and then conducting data exfiltration

- Ransomware
	- A type of malicious software that is designed to block access to a computer system or its data by encrypting it until a ransom is paid to the attacker
	-  Conducting regular backups
		- Should be stored on physical on-prem datacentre
		- Second backup using cloud-based solutions
			- Which aren't connected to your main system
	- Installing regular software updates
		- Especially OSs and Anti-virus programs
	- Providing security awareness training
		- The majority of attacks arise because of users clicking a link and being phished via a link in an email
	- Implementing MFA for the systems
		- Makes it difficult for attackers to breach accounts
	- What should you do if you get infected? 
		- Never pay the ransom
		- They might not even decrypt the data..
		- Encourages the attackers and known attackers to further exploit you
		- Disconnect any infected machines from the network
		- Notify the Authorities
		- Refer to the Incident Response Plan first
			- Perhaps this details to handle the process internally first
		- Restore the data from known good backups

- Zombies and Botnets
	- Botnets
		- Network of compromised computers or device controlled remotely by malicious actors
		- Created by using other types of malware, to gain access to a system and then add it to a botnet wherein it will be able to control its:
			- Processing
			- Memory
			- Storage
			- Networking
		- Made up of 100s, 1000s, even millions of Zombies
	- Zombies
		- Name of a compromised computer or device that is part of a botnet and used to perform tasks using remote commands
	- Command and Control Node
		- Responsible for managing and coordinating the activities of other nodes or devices within a network
	- Can make it look like it is your device that is making an attack
	- Examples for the use of botnet
		- Illicit material like child pornography can be stored across this botnet as opposed to on the malicious person's own devices
		- Using to spam others by sending out phishing campaigns and other malware
		- Conducing a DDoS attack (distributed denial of service)
			- Targeting one device/note on the network (Internet)
		- Crypto-mining through the botnet
		- Combine processing power to break through different types of encryption schemes
	- Usually use low-resources on the zombie machines

- Rootkits
	- Type of software that is designed to gain administrative-level control over a given computer system without being detected
	- Allows to:
		- Install programs
		- Delete programs
		- Open ports
		- Shut ports
		- Whatever .. It's root/administrator
	- How it works
		- Rings of permission
		- Ring 3
			- Standard user
		- Ring 1
			- Root/admin user
			- Easier to do more damage on a system, as there's more access
		- Ring 0
			- Kernel mode
				- Device drivers, sound card, monitor
				- Most trusted, and most powerful ring
	- Run on Ring 0 and Ring 1
	- Rootkits will try to go from Ring 1 to Ring 0 to stay hidden and be able to do more
	- Designed to dig deeply into the OS
	- DLL Injection
		- Technique used to run arbitrary code within the address space of another process by forcing it to load a dynamic-link library
		- DLL
			- A collection of code and data that can be used by multiple programs simultaneously
			- To allow for code re-use and modulization 
			- Usually provided by default in Windows
		- Manipulates a DLL to run malicious code upon system start-up, so that the OS doesn't even know that the DLL has been altered with, or that it has a root-kit running on it
	- SHIM
		- Software code that is placed between two components
		- Intercepts calls between those components
			- and redirects those calls
		- Will intercept between Windows and the DLL, redirects that call when its embedded into some kind of malicious code that's embedded inside of it
	- Difficult to detect
	- Boot from an external device and then scan the internal HDD or SDD to detect rootkits from a decent anti-malware solution from a live boot Linux distribution
	- A rootkit is a type of software that is designed to gain administrative-level control over a given computer system without being detected
	- Primary objective is to seamlessly embed itself into the OS by exploiting trust with the DLL system, using a DLL injection and the SHIM technique
	- Conduct an external system scan for best practices
	- Continuous vigilance and implementation of robust security measures across the entire enterprise system and are required against rootkits

- Backdoors and Logic Bombs
	- Used to bypass the normal security and authentication functions
	- Easter Egg
		- Insecure coding practice that was used by programmers to provide a joke or a gag gift to the users
		- Generally harmless
		- But can have vulnerabilities
			- Normally doesn't go through the rigorous testing like the main code does
	- Logic Bomb
		- Malicious code that is inserted into a program, and will only execute when certain conditions have been met
		- Maybe an employee left one that will delete all files on a server upon their account being disabled
	- Backdoor
		- Covert method of bypassing normal authentication or normal security measures that is designed by programmers

- Keylogger
	- A piece of software or hardware that records every single keystroke that is made on a computer or mobile device
	- Every keystroke is sent to a remote device
	- Can lead to:
		- Identity theft
		- Financial fraud
		- Corporate espionage
	- Software-based
		- Installed on a victims computer
		- Usually bundled with other software
			- and social engineering and phishing attacks
		- Once activated, it can operate silently in the background and transmit signals/keystrokes to the threat actors involved
	- Hardware-based
		- USB thumbdrives
		- In the keyboard themselves
		- OS would think it's a regular keyboard for the most part
	- Risk to privacy
		- Usernames
		- Passwords
		- Credit Card Numbers
	- Corporate risks, breach of:
		- Login Credentials
		- Contents of confidential emails
		- Company's proprietary data
		- Company's strategic plans
	- Could result in:
		- Financial losses
		- Damage to the organisations reputation
		- Legal repercussions
		- Loss of competitive advantage
	- To help prevent keyloggers:
		- Ensure performing regular updates and patches
		- Rely on quality anti-virus and anti-malware solutions
		- Conduct phishing awareness training for all end-users
		- Implement MFA systems
		- Encrypt keystrokes that are sent to systems
		- Perform physical checks of desktops, laptops and servers

- Spyware and Bloatware
	- Spyware
		- A type of malicious software that is designed to gather and send information about a user or a organisation
		- Bundled with other software
		- Installed through a malicious website
		- Installed when users click on a deceptive pop-up advertisement
		- Utilises system resources
	- Read through EULAs
		- To see if any software installed is collecting data as part of this agreement
	- Update
	- Bloatware
		- Any software that comes pre-installed on a new computer or smartphone
		- Wastes storage space
		- Slows down performance
		- Introduces new security vulnerabilities
		- Remove any extra software or applications that are not being used on a daily basis
			- Manually remove it
			- Bloatware removal tools
			- Perform a clean operating system installation on a new device
				- Don't use the preinstalled jazz.

- Malware Attack Techniques
	- Describes the specific method by which malware code infects a target host
	- Some focus on infecting the systems memory toe leverage remote procedures calls over an organisation network
	- Most modern malware uses fileless techniques to avoid detection by signature-based security software
	- Fileless Malware
		- Used to create a process in the system memory without relying on the local file system of the infected host
		- Hard to detect
		- Leaves behind very few traces compared to file-based malware
	- Two-stage implementation model
		- Stage 1 - Dropper or Downloader
			- When a user clicks on a malicious link or opens a malicious file, malware is installed
			- Dropper
				- Initiates or runs other malware forms within a payload on an infected host
			- Downloader
				- Retrieves additional tools post the initial infection facilitated by a dropper
			- Shellcode
				- Encompasses lightweight code meant to execute an exploit on a given target
		- Stage 2 - Downloader
			- Download and install a remote access Trojan to conduct command and control on the victimised system
	- Actions on Objectives Phase
		- Threat actors will execute primary objectives to meet core objectives (data exfiltration or file encryption)
	- Conduct Concealment
		- Used to help the threat actor to prolong unauthorised access to a system by hiding tracks, erasing log files, and hiding any evidence of malicious activities
	- Can be delivered by:
		- Code Injection
			- Used to disguise malicious code by running it with the identification of a legit process
			- Can be combined with anti-forensic strategies, like encryption, compression and obfuscation - to make it challenging for cyber security professionals to detect and analyse these threats
		- Masquerading
		- DLL injection
		- DLL sideloading
		- Process hollowing
	- Living Off The Land
		- A strategy adopted by many APTs and criminal organisations
		- Threat actors try to exploit the standard system tools to perform intrusions
		- ie PowerShell
		- It is important to be aware of these types of techniques

- Indications of Malware Attacks
	- Account lockouts
		- Red flag that someone is trying to breach the network
		- Surge in account locks?
	- Concurrent session utilisation
		- A user should typically only have one active session at any given time
		- Any more than this? Out of the baseline?
	- Blocked content
		- Modern cyber security tools will have the ability to block known malicious content
		- If there is an increase seen in this blocked content in the system
			- It could be a sign that malware has infected the system
	- Impossible travel
		- When a user's account is accessed in two geographically different locations and at a similar time
		- Can be an indication that an account has been compromised
	- Resource consumption
		- If an observation of increased levels of system/resource utilisation - can be a sign of an infection 
	- Resource inaccessibility 
		- Ransomware
		- Large spike in reports of unable to access files? 
	- Out-of-cycle logging
		- If you see that logs are being generated at weird hours could be an indication
	- Missing logs
		- Usually threat actors will delete logs after doing their nasty business
		- A large gap in logs is an indication
	- Published or documented attacks