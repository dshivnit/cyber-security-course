- Windows Domain
	- A group of Users and Computers under the administration of a given business
	- Active Directory:
		- The main idea behind WinDomains are to centralise the administration of common components of a Windows Computer Network in a single repository called, AD (or Active Directory)
	- Domain Controller:
		- The Server that runs the AD services is known as the DC - or Domain Controller

- Centralised Identity management:
	- All Users across the network can be configured from within AD and with minimum effort
		- Meaning you don't have to go through to each machine to configure a local profile, there will be the use of what are called Domain Profiles (or well Windows Domain Profiles) which Users will log into on Computers that are in the Windows Domain as well
	- Managing Security Policies
		- Security/Group Policies can be configured directly from within Active Directory and can be applied to Users and Computers across the Domain/Network as required

- Active Directory Domain Service(AD DS)
	- Acts as a catalogue that holds information related to all of the *objects* that are in the on the network
		- Users
			- Security principals
				- They can be auth'd by the domain and assigned privileges over resources (files printers etc)
			- People
			- Services
				- IIS
				- MySQL
				- Services will require a User object to run them - so in these instances, the object won't represent a person as such, but a system/service account
		- Groups
		- Machines
			- Security principals
		- Printers
		- Network Shares
		- And more
	- Security Groups
		- Define access levels to various resources on the network/system (Domain)
		- Domain Admins
		- Server Operators
		- Backup Operators
		- Account Operators
		- Domain users
		- Domain Computers
		- Domain Controllers
	
	- Organisational Units
		- The hierarchy of and containers of 
			- Users
			- Computers
			- Groups
		- Handy for applying policies to User and Computers

- Computers Container
	- Good practice to segregate devices defining what purpose they are serving 
		- Workstations
		- Servers
		- Domain Controllers

- GPOs (or Group Policy Objects)
	- A collection of settings that can be applied to OUs (Organisational Units) 
	- Can contain policies aimed at either Users or Computers, allowing you to set a baseline on specific machines and identities. 
	- Group Policy Management tool
		- Note that these types of Windows Domain Tools are installed (if chosen as services to install) on a Windows Server distribution such as Windows Server 2019
	- Active Directory (Users and Computers)
	- etc
	- GPOs are distributed to the network via a network share called `SYSVOL` which is stored in the DC 
		- All Users in the Domain should normally have access to this share over the network to sync their GPOs periodically. 
		- The SYSVOL share points by default to the `C:\Windows\SYSVOL\sysvol\` directory on each of the DCs in the network (replication)
		- Once any changes are made to any GPOs, it can take up to two hours for computers to catch up. 
		- You can force a computer to sync its GPOs by forcing a gpupdate
			- `gpupdate /force`

- Credentials are stored in the DCs
- When a subject tries to authenticate to a service, the service will ask the DC to verify 
- Two protocols are used for Network Authentication:
	- Kerberos
		- Used by any recent version of Windows - the DEFAULT protocol
	- NetNTLM
		- Legacy protocol kept for compatibility 

- KERBEROS! Authentication
	- Users who log into a service using Kerberos will be assigned tickets
		- A proof of a previous authentication
	- This happens:
		- User sends their uname and a timestamp encrypted using a key derived from their password to the KDC - Key Distribution Centre
			- KDC - A service usually installed on the DC in charge of creating Kerberos tickets on the network/domain
		- The KDC will create and send back a TGT (Ticket Granting Ticket) which will allow the User to request additional tickets to be able to access specific services. 
			- Pretty much Tickets needed to get more Tickets
		- It allows Users to request for Service Tickets without passing their credentials every time they want to connect to a service
		- A Session Key is given to the User, which they will need to generate requests
	- The TGT is encrypted using KRBTGT hash
		- A User can't access its contents
		- The TGT also has a copy of the Session Key as part of its contents
	- The KDC doesn't need to store the Session Key, it can decrypt it if it needs to 
	- TGS
		- Ticket Granting Service
	- Users will send their Uname, Timestamp, Session Key, and TGT, TGT and an SPN (Service Principal Name) (SPN indicates the service and the server name that is intending to be accessed)
	- The KDC will send the TGS along with a SERVICE SESSION KEY which will need to authenticate to the service that is wanting to be accessed
	- The TGS is encrypted with a key derived from the Service Owner Hash
	- The TGS can then be sent to the desired service to authenticate and establish a connection
	- The Service will use its configured account's password hash to decrypt the TGS and validate the Service Session Key

- NetNTLM Authentication
	- The Client sends an authentication request to the Server they want to access
	- The Server generates a random number and sends it as a challenge to the Client
	- The Client combines their NTLM password hash with the challenge (and other known data) to generate a response to the challenge and sends it back to the Server for verification. 
	- The Server forwards the challenge and the response to the DC for verification
	- The DC uses the challenge to recalculate the response and compares it to the original response sent by the Client
	- If they both match then the Client is authenticated and whatever the result is will be sent back to the Server
	- The Server forwards the authentication result to the Client
	- The User's password (or hash) is never sent through the network

- Trees
	- Needed when a company expands, especially into different regions wherein different IT teams could be looking after the system/domains
	- Also to comply with different local regulations (ie different countries, etc)
	- One solution is to have a massive OU - but this can get complicated and prone to errors (human ones)
	- What you can do is integrate multiple domains so that you can partition the network into two units that can be managed independently 
	- If you have two domains that share the same namespace (ie `learning.local`) - they can be joined by what is called a Tree
		- say for example `country1.learning.local` and `country2.learning.local`
		- Each of them will have their own computers and users within
	- These two DCs will then connect to the main DC
	- Either of the branched DCs will not be able to manage each other (keep that in mind) 
		- Goes the same for the GPOs within each 
	- Enterprise Admins - these users will have admin privileges over all domains in the tree/forest

- Forests
	- This is what a domain with different namespaces connected is called
	- Two completely different enterprise domains with different names
		- ie `company1.local` and `company2.local` 

- Trust Relationships
	- Between the sub-domains, and different domains 
		- (not sure if the terminology I've used just now is accurate, but I hope you get what I mean )
	- One-way Trust Relationship
		- Speaks for itself
		- Admins from one domain can access resources on the other domain, but not the other way around
	- Two-way Trust Relationship
		- What can be accessed can be configured

